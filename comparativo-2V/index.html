<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comparativo Presidencial â€” Dashboard 2025</title>

  <!-- Roboto -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css" />
</head>

<body class="light">

  <!-- ===== TOPBAR ===== -->
  <header class="topbar">

    <!-- Primera fila: TÃ­tulo + Darkmode -->
    <div class="topbar-row">
      <div class="logo">ðŸ“Š Dashboard Electoral 2025</div>
      <button id="themeToggle" class="theme-btn">ðŸŒ™</button>
    </div>

    <!-- Segunda fila: menÃº -->
    <nav class="menu-under-title">
      <button onclick="showTab('perfil')" class="tab-btn active">Perfil</button>
      <button onclick="showTab('comparativa')" class="tab-btn">Comparativa</button>
      <button onclick="showTab('resultados')" class="tab-btn">Resultados</button>
    </nav>

  </header>

  <!-- ===== CONTENIDO ===== -->

  <!-- === PERFIL PROFESIONAL === -->
  <section id="perfil" class="tab-section">
    <h2>Perfil Profesional</h2>
    <div id="perfil-container" class="perfil-grid"></div>
  </section>

  <!-- === COMPARATIVA === -->
  <section id="comparativa" class="tab-section" style="display:none;">
    <h2>Comparativa por TemÃ¡tica</h2>

    <div class="tematicas-carousel" id="tematicasCarousel"></div>

    <div id="cardsTematica" class="cards-container"></div>
  </section>

  <!-- === RESULTADOS === -->
  <section id="resultados" class="tab-section" style="display:none;">
    <h2>Resultados Primera Vuelta</h2>

    <div class="bar-chart-container">

      <!-- JARA -->
      <div class="bar-row">
        <span class="bar-label">Jeannette Jara</span>
        <div class="bar-track">
          <div class="bar-fill jara" style="--w: 26.75%;"></div>
        </div>
        <span class="bar-value">26.75% â€¢ 2.156.492 votos</span>
      </div>

      <!-- KAST -->
      <div class="bar-row">
        <span class="bar-label">JosÃ© Antonio Kast</span>
        <div class="bar-track">
          <div class="bar-fill kast" style="--w: 23.96%;"></div>
        </div>
        <span class="bar-value">23.96% â€¢ 1.932.000 votos</span>
      </div>

      <!-- OTROS -->
      <div class="bar-row">
        <span class="bar-label">Otros Candidatos</span>
        <div class="bar-track">
          <div class="bar-fill otros" style="--w: 49.29%;"></div>
        </div>
        <span class="bar-value">49.29% â€¢ 3.970.894 votos</span>
      </div>

    </div>
  </section>

  <!-- ===== SCRIPTS ===== -->
  <script>
    /* ------------------- TAB SWITCH ------------------- */
    function showTab(tab) {
      document.querySelectorAll('.tab-section').forEach(sec => sec.style.display = 'none');
      document.getElementById(tab).style.display = 'block';

      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.querySelector(`[onclick="showTab('${tab}')"]`).classList.add('active');
    }

    /* ------------------- DARK MODE ------------------- */
    const toggleBtn = document.getElementById("themeToggle");
    toggleBtn.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      toggleBtn.textContent = document.body.classList.contains("dark") ? "â˜€ï¸" : "ðŸŒ™";
    });

    /* ------------------- PERFILES ------------------- */
    fetch("./data/perfiles.json")
      .then(res => res.json())
      .then(data => {
        const cont = document.getElementById("perfil-container");

        data.candidatos.forEach(c => {
          cont.innerHTML += `
          <div class="perfil-card">
            <div class="perfil-header">
              <h3>${c.nombre}</h3>
            </div>

            <p class="perfil-bio">${c.biografia}</p>

            <ul class="hitos-list">
              ${c.hitos.map(h => `
                <li>
                  <span class="hito-titulo">${h.titulo}:</span>
                  <span class="hito-desc">${h.descripcion}</span>
                </li>
              `).join("")}
            </ul>
          </div>`;
        });
      });

    /* ------------------- COMPARATIVO ------------------- */
    let comparativoData = [];

    fetch("./data/comparativo.json")
      .then(res => res.json())
      .then(data => {
        comparativoData = data;

        const carousel = document.getElementById("tematicasCarousel");
        const tematicasUnicas = [...new Set(data.map(item => item.Tematica))];

        const ICONS = {
          "EconomÃ­a": "ðŸ“Š", "Seguridad": "ðŸ›¡", "Salud": "ðŸ¥", "Pensiones": "ðŸ’°",
          "EducaciÃ³n": "ðŸŽ“", "Vivienda": "ðŸ ", "Transporte": "ðŸš†", "EnergÃ­a": "âš¡",
          "Medio Ambiente": "ðŸŒ¿", "Justicia": "âš–ï¸", "Relaciones Exteriores": "ðŸŒŽ",
          "Cultura": "ðŸŽ­", "DigitalizaciÃ³n / IA": "ðŸ¤–", "Empleo": "ðŸ’¼"
        };

        tematicasUnicas.forEach(t => {
          carousel.innerHTML += `
            <div class="tematica-card" onclick="mostrarPorTematica('${t}', this)">
              <span class="tematica-icon">${ICONS[t]}</span>
              <span class="tematica-label">${t}</span>
            </div>`;
        });
      });

    /* ------------------- MOSTRAR POR TEMÃTICA ------------------- */
    function mostrarPorTematica(tematica, cardElement) {
      document.querySelectorAll(".tematica-card").forEach(el => el.classList.remove("active"));
      cardElement.classList.add("active");

      const cont = document.getElementById("cardsTematica");
      cont.innerHTML = "";

      const filtrados = comparativoData.filter(item => item.Tematica === tematica);

      filtrados.forEach(item => {
        cont.innerHTML += `
        <div class="card">
          <h4>${item.Tematica}</h4>
          <p><strong>${item.Candidato}:</strong> ${item.Propuesta}</p>
          <a href="${item.LinkPrograma}" target="_blank" class="btn-link">Ver programa completo</a>
        </div>`;
      });
    }
  </script>

</body>
</html>
